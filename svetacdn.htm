<!DOCTYPE html>
<html lang="ru" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>svetacdn</title>
    <link rel="icon" type="image/x-icon" href="/DygDygWEB/svetacdn.jpg">
    <script src="https://kinobox.tv/kinobox.min.js"></script>
</head>
<style>
    html {
        color-scheme: light dark;
    }

    iframe#kodik {
        width: 100%;
        height: 100%;
        position: absolute;
    }

    body {
        overflow: hidden;
        margin: 0px
    }

    .kinobox_player {
        width: 100%;
        height: 100%;
        position: absolute;
        overflow: hidden;
    }

    :root {
        overflow: hidden;
    }

    #search {
        width: 100%;
        height: 100%;
        display: flex;
        flex-wrap: wrap;
        align-content: center;
        justify-content: center;

    }


    .cover_image {
        width: 100%;
        height: auto;
        aspect-ratio: 1 / 1.5;
        object-fit: cover;
        background: #222;
        position: relative;
        border-radius: 12px;
        border-color: rgba(255, 0, 0, 0);
        border: solid;
    }

    .cart {
        width: 200px;
        margin: 6px;

    }

    .cart:hover {
        .cover_image {
            border-color: aqua;
        }

        .title {
            /* display: flow; */
            color: aqua;
        }
    }

    .cart_img {
        width: 100%;
        height: 100%;
        display: flow;
    }

    .year {
        position: fixed;
        z-index: 1;
        background-color: #222;
        border-radius: 7px;
        padding: 4px;
        margin: 10px;
    }

    .type {
        position: fixed;
        /* z-index: 2; */
        /* right: 0; */
    }

    .title {
        display: none;
        display: block;
        text-align: center;
        /* background-color: rgba(70, 70, 70, 0.962); */
        color: beige;
    }
</style>

<body>

</body>

<script>
    let playerConfigs = { "file": "~mlI-Y-fNMw9oiJBWRHfimbpicZBSQzD0cYJHEN7TEgNhSJ+Gixw3RZX9kiajhL7ctdvQuSsNe86Dt6fEKFS5aUdXEyR43HUvN1DNbhXHJEcNtsTERV+eKDr1EbiAXOd8bTUFh99Tb3edWGBnBgi5it6VGnI4cBMnky7+SZZr-RLzFmrzsGCAMW1RcCuRebu5M1cDqSCAvvaPyJhlsJXpA+0a$HBzOL9YmZ91tL9vrfTrY-LYE8bn0-pm7IMd50ZS8zcVkKSgCAzXPc75G4405Q!!", "hls": 0, "country_list": false, "user_country": "ru", "translator": "107", "id": "player-0fcdce1063bdce922a51ec915b7f9fd7", "cuid": "0fcdce1063bdce922a51ec915b7f9fd7", "key": "qDOJZihSc8m5kU75EwDUkJOFbhv0rBBj1j+ZhkMzUy+n-g1-kol4DskOkkUg78kA", "movie": "0fcdce1063bdce922a51ec915b7f9fd7", "host": "films-smotret.online", "masterId": "543", "masterHash": "6a6050cefe9983b204c28fdadc9fd30f", "userIp": "176.193.204.189", "poster": "", "p2p": true, "rek": { "preroll": ["https:\/\/aj1907.online\/zl7RmCFJuxYfgmUiQP0A7iR_ejIspofF73vUgp0eqd5sGiXVNo01fxLlereqtX4ZuqH7zw5N5512kexuQWInHirPdh0F0qkU", "https:\/\/aj1907.online\/zeiQP4JCJSSPGWGfE48Hzm7Gq9J70C-zQPgHmxq5cW_-n9Qe7-yn-h5Tn-fKQ6AHGXg5s45Cg97mLjzDSrED3S0wsXeWItzY"], "midroll": [{ "time": "7%", "url": "https:\/\/aj1907.online\/ztRNubDJshz8pWnA9urRGAznNmgil8wal_e5UdMjDEp6JziE1wGKIDat02nS-tmVlN-ZQl_vSIYmzJvoAa7i_NKLtcEckgSA" }, { "time": "20%", "url": "https:\/\/aj1907.online\/zbXin1pugQdBDLZiMtgMkAq5FdSrgcUSn5Yju3Us-_gH-Ug7PyCKkp4VdhFfZzDWMbGwvc-Rz7zbEOdPoQUj54pO-l3p_LQc" }, { "time": "40%", "url": "https:\/\/aj1907.online\/zHoglZ2qAoQelUuKdkYCRAyJttJF0XKyd1HoNHN2BvsLSVl-NLw9VH1VHdHVvpNKJi1ucUKJV4X7vk6ZYji8B1Y5fElNHYAA" }, { "time": "60%", "url": "https:\/\/aj1907.online\/zgZPa2DU8JxzNs61DhSi5Z_psmS7BoFnj2eiixRKEvMPoSKcU7RrWYimkvSY1ncWYJ81M2KwfqX_7MrzHtgNiWcuIwSOlbvs" }], "pausebanner": { "key": "bbe8fc89d1b4ec0363fafb361a1f5ab9", "script": "https:\/\/aj1907.online\/63c0d7d8.js", "show": true }, "endtag": { "key": "6c4661276978c9c87d15d0ba61646a8c", "script": "https:\/\/aj1907.online\/63c0d7d8.js", "conf": { "show_time": 60, "skip_time": 15, "movie_et": "0", "banner_show": true, "banner_time": 600 } }, "starttag": [], "pushbanner": [], "qr_code": null }, "href": "vb17123filippaaniketos.pw", "kp": "505898", "uniq_hash": "ebd23619d520ed369509b25c97e9ed3c" };
    let loadserv = getUrlParameter("loadserv")

    function load(service) {
        // var proxy = `//p3.hosteagle.club/?__cpo=`
        var kp = '5401195';
        var kodik = document.createElement("div");
        // var link = `https://proxysite.cloud/?cdURL=https%3A%2F%2F7224.svetacdn.in%2FMr1qo9bwHfJQ%3Fkp_id%3D5401195#`
        // var link = `https://proxysite.cloud/?cdURL=`+btoa(`https://7224.svetacdn.in/Mr1qo9bwHfJQ?kp_id=${getUrlParameter("kinopoiskID")}`)
        if(getUrlParameter("shikimoriID")){
            var link1 = `//kodik.cc/find-player?shikimoriID=${getUrlParameter("shikimoriID")}`
        }else{
            var link1 = `//kodik.cc/find-player?kinopoiskID=${getUrlParameter("kinopoiskID")}`
        }
        var link2 = `//${getRandomInt(999999999999)}.svetacdn.in/Mr1qo9bwHfJQ?kp_id=${getUrlParameter("kinopoiskID")}`
        var link3 = `//api.linktodo.ws/embed/kp/${getUrlParameter("kinopoiskID")}`

        // if(service=="sv") kodik.innerHTML = `<iframe id="kodik" src="${link}" frameborder="0"  AllowFullScreen allow="autoplay *; fullscreen *"></iframe>` ;
        switch (service) {
            case "kodik":
                kodik.innerHTML = `<iframe id="kodik" src="${link1}" frameborder="0"  AllowFullScreen allow="autoplay *; fullscreen *"></iframe>`
                break;

            case "linktodo":
                kodik.innerHTML = `<iframe id="kodik" src="${link3}" frameborder="0"  AllowFullScreen allow="autoplay *; fullscreen *"></iframe>`
                break;

            case "svetacdn":
                kodik.innerHTML = `<iframe id="kodik" src="${link2}" frameborder="0"  AllowFullScreen allow="autoplay *; fullscreen *"></iframe>`

                break;
            default:
                // document.body.innerHTML = '<div class="kinobox_player">'
                // searchkinobox(getUrlParameter("kinopoiskID"), getUrlParameter("imdb"), getUrlParameter("tmdb"), getUrlParameter("title"), getUrlParameter("query"), getUrlParameter("shikimori"))

                break;
        }

        // if (service == "kodik") {
        //     kodik.innerHTML = `<iframe id="kodik" src="${link1}" frameborder="0"  AllowFullScreen allow="autoplay *; fullscreen *"></iframe>`
        // } else {
        //     kodik.innerHTML = `<iframe id="kodik" src="${link2}" frameborder="0"  AllowFullScreen allow="autoplay *; fullscreen *"></iframe>`
        // };

        document.body.prepend(kodik);
        
        if (getUrlParameter("title")) document.title = `${getUrlParameter("title")}` //Получает заголовок из параметров title
        if (getUrlParameter("TitleTab")) document.title = `${getUrlParameter("TitleTab")}` //Получает заголовок из параметров TitleTab
    };
    load(loadserv)
    /////////////////////////////////////////////// utilitis //////////////////////////////////////////
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    };

    function getRandomInt(max) {
        return Math.floor(Math.random() * max);
    }
    function searchkinobox(kinopoisk, imdb, tmdb, title, query, shikimori) {
        if(shikimori){
            var url = `https://kodikapi.com/search?token=45c53578f11ecfb74e31267b634cc6a8&shikimori_id=${shikimori}`
            fetch(url)
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {

                        if (response.status == "404") return response.status

                        throw new Error('Ответ сети был не в порядке. searchkinobox');
                    }
                })

                .then(data => {
                    console.log(data.results.length)
                    // data.results[0]?.imdb_id
                    data.results.length>0 ? Startkinobox(data.results[0]?.kinopoisk_id, data.results[0]?.imdb_id) : searchkinobox(kinopoisk, imdb, tmdb, title, query)
                })
                return
        }

        if (query) {

            var url = `https://kinobox.tv/api/films/search/?title=${query}`

            fetch(url)
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {

                        if (response.status == "404") return response.status

                        throw new Error('Ответ сети был не в порядке. searchkinobox');
                    }
                })

                .then(data => {
                    if (data == "404") {

                        return data
                    }
                    console.log(data, query)
                    document.body.innerHTML = `
                        <div id="search"></div>
                    `

                    var search = document.getElementById("search")
                    search.style.cssText = `

                    `

                    data.forEach(e => {
                        // console.log(e)
                        const cart = document.createElement('div');
                        cart.classList.add('cart')
                        search.appendChild(cart)
                        cart.innerHTML = `
                        <div class="year">${e.year}</div>
                        <div class="type">${e.type}</div>
                        <img class="cover_image" src="${e.posterUrl}"></img>
                        <div class="title">${e.title}</div>
                        `
                        cart.addEventListener('click', () => {
                            // search.remove()
                            location.href = `${location.origin}${location.pathname}?kinopoiskID=${e.id}`
                            // Startkinobox(e.id.toString())
                        })
                    });

                    // Startkinobox(null, null, null, null, data[0].id)
                    // sh_api.Last_search = data
                    // console.log(sh_api.Last_search)
                })
                .catch(error => {

                    console.error('Возникла проблема с операцией выборки searchkinobox:', error);
                });
        } else {
            Startkinobox(kinopoisk, imdb, tmdb, title)
        }

    }
    function Startkinobox(kinopoisk, imdb, tmdb, title) {
        console.log(kinopoisk, imdb, tmdb, title)
        kbox('.kinobox_player', {
            search: { // Настройки поиска
                kinopoisk: kinopoisk, // Поиск фильма по ID Кинопоиска
                imdb: imdb, // Поиск фильма по IMDb Id
                tmdb: tmdb, // Поиск фильма по TMDB Id
                title: title // Поиск фильма по названию
            },
            menu: { // Настройки меню
                enable: true, // Показывать меню
                default: getUrlParameter("menu_default") ? getUrlParameter("menu_default") : 'menu_list', // Вид меню для стандартных устройств menu_list
                mobile: getUrlParameter("menu_default") ? getUrlParameter("menu_default") : 'menu_button', // Вид меню для мобильных устройств menu_button
                format: '[{N}] {S} :: {T} ({Q})', // Формат пункта меню
                limit: null, // Максимальное количество элементов в меню
                open: getUrlParameter("menu_open") ? getUrlParameter("menu_open") : false, // Открывать меню по умолчанию
            },
            players: { // Настройки источников

                alloha: { // Название
                    enable: true, // Включить
                    position: 1 // Позиция в меню
                },
                kodik: {
                    enable: false,
                    position: 2
                },
                cdnmovies: {
                    enable: true,
                    position: 3,
                    domain: 'https://cdnmovies-stream.online',
                },
                videocdn: {
                    enable: true,
                    position: 4,
                    domain: `https://${getRandomInt(999999999999)}.svetacdn.in/gzIOdW6ZBYvH`
                    // ${getRandomInt(999999999999)}.svetacdn.in/Mr1qo9bwHfJQ?kp_id=${getUrlParameter("kinopoiskID")}`
                },
                Ashdi: {
                    enable: true,
                    position: 5,
                },
                Collaps: {
                    enable: true,
                    position: 6,
                },
                Hdvb: {
                    enable: true,
                    position: 7,
                },
                Voidboost: {
                    enable: true,
                    position: 5,
                },
                linktodo: {
                    enable: true,
                    position: 6,
                },
                svetacdn: {
                    enable: true,
                    position: 7,
                },
                turbo:{
                    enable: true,
                    position: 8,
                },


            },
            params: { // Добавление дополнительных параметров в ссылку iframe
            }
        });
    }
</script>


</html>